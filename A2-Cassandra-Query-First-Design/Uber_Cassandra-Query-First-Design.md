# UBER : Cassandra Query First Design

## Introduction

## RDBMS Schema Analysis

### Entity Relation

![alt text](images/uber_er.png)
_Figure 1-1. Entity-relationship diagram for Uber application_

### Relational Modelling

![alt text](images/uber_physical_design.png)

_Figure 1-2. Physical data model for Uber application_

## Query Analysis

#### Transaction Processing Queries

- Q1: (Passenger checking for Uber) Get all the available cars ( fare and arrival time) for the current location with a given radius grouped by car type with lowest arrival time.

- Q2: (System checking for available cars) get all the cars of a given type within radius of the given location.

- Q3: (System compute dynamic fare) : base fare + compute demand ( ratio of passenger waiting for car / number of available around a given location ).

- Q4: (Drive checking passenger details before accepting ) Get passenger details with given passenger id.

- Q5: (Passenger checking Driver information) get driver details with given driver id.

- Q6: Compute the surge fare.

#### Analytical Queries

- Q7 (Compute Passenger rating) get all the past trips for a given Passenger
- Q8 (Compute Driver rating) get all the past trips for a given Driver
  (Drive view, trip history ): get all the trips for a given Driver for a given day
- Q9 (Drive view, revenue): get total sum of revenue of given day
  (Company view, revenue): get total sum of revenue of given day, time slot, area

- Q11: How many trips has a passenger made within a certain time period?
- Q12: What is the average rating of a driver based on completed trips?
- Q13: What types of payment methods does a passenger use most frequently?
- Q14: Which cars (make and model) are most used by a particular driver?
- Q15: What is the average fare and tip size for trips of a particular ride type?
- Q16: How many rides have a driver canceled over the last year, and what were the penalties?
- Q17: For which rides did passengers leave rating, and what were those rating?
- Q18: What is the total fare generated by a particular car (identified by VIN) over its lifetime of service? --
- Q19: Can we list all drivers who have not driven in the past month?
- Q20: What are the most common pickup locations across all trips?

## Cassandra Schema Design

Sample Query

```sql
SELECT * FROM system_schema.keyspaces;
```

## Discussion

## Conclusion
